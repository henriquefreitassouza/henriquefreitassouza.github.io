<!DOCTYPE html>
<html class="" lang="pt" dir="ltr">
  <head>
    <title>Gera√ß√£o de relat√≥rios automatizados por APIs | Automa√ß√£o de Dados</title>

<meta http-equiv="Content-Type" content="text/html" charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Como utilizar APIs para automatizar a gera√ß√£o de relat√≥rios?" />
<meta property="og:title" content="Gera√ß√£o de relat√≥rios automatizados por APIs">
<meta property="og:description" content="Como utilizar APIs para automatizar a gera√ß√£o de relat√≥rios?">
<meta property="og:url" content="https://henriquefreitassouza.github.io/stories/geracao-de-relatorios-automatizados-por-apis/">
<meta property="og:site_name" content="Automa√ß√£o de Dados">

<meta property="og:image" content="https://henriquefreitassouza.github.io/stories/geracao-de-relatorios-automatizados-por-apis/images/thumbnail.webp">
<meta name="twitter:card" content="https://henriquefreitassouza.github.io/stories/geracao-de-relatorios-automatizados-por-apis/images/thumbnail.webp">
<meta name="twitter:image:alt" content="Dashboard sendo apresentado em computador.">


    <link href="/images/favicon.ico" rel="icon" type="image/x-icon" />

	
	<link rel="alternate" hreflang="en" href="https://henriquefreitassouza.github.io/en/stories/geracao-de-relatorios-automatizados-por-apis/" title="English">
	

<link rel="preload" as="script" href="/js/ui.min.js" />
<link rel="preload" as="script" href="/js/theme.min.js" />
<link rel="preload" as="style" href="/css/fonts.min.css" />
<link rel="preload" as="style" href="/css/main.min.css" />
<link rel="stylesheet" href="/css/fonts.min.css" />
<link rel="stylesheet" href="/css/main.min.css" />
<script src="/js/ui.min.js" async></script>

    
  </head>
  <body class="overflow-x-hidden dark:bg-secondary">
    <div class="flex flex-col h-screen">
      <a class="sr-only focus:sr-only" href="#content">Pular para o conte√∫do</a>
      <header class="flex flex-col justify:between">
  <div class="container container-box mx-auto lg:px-0">
    <div class="px-2 flex flex-wrap justify-between items-center">
      <div class="w-6/12 md:w-auto">
        <a href="/" class="flex items-center mr-2 font-title no-underline hover:no-underline focus:outline-none focus:ring-2 focus:ring-offset-8 focus:ring-secondary-darker dark:ring-offset-secondary dark:ring-white">
          <img class="mr-2 w-16 h-8" id="site-logo" src="/images/automacaodedados_logo.svg" alt="Logo Automa√ß√£o de Dados">
          <span class="text-base font-title leading-none mb-0 break-words dark:text-white">Automa√ß√£o de Dados</span>
        </a>
      </div>
      <div class="flex items-center lg:order-last">
        <a class="p-2 mr-2 inline-block no-underline focus:outline-none focus:ring-2 focus:ring-secondary-darker dark:focus:ring-white lg:mr-0 lg:ml-2" id="theme-menu-toggle" href="#" title="Trocar entre temas escuro e claro">
          <span class="sr-only">Trocar entre temas escuro e claro</span>
          <i class="w-7 h-7" id="theme-toggle-icon"></i>
        </a>
        <a id="navigation-menu-toggle" class="p-2 inline-block text-base no-underline focus:outline-none focus:ring-2 focus:ring-secondary-darker dark:focus:ring-white lg:hidden" role="button" aria-owns="main-menu" aria-controls="main-menu" aria-expanded="false" href="#main-menu">
          <span class="sr-only">Abrir e fechar navega√ß√£o principal</span>
          <i class="navigation-menu-icon w-7 h-7 dark:filter dark:invert" id="navigation-toggle-icon"></i>
        </a>
      </div>
      <div id="main-menu" class="flex flex-grow mt-4 hidden targeted:block lg:block lg:w-auto lg:mt-0" aria-labelledby="navigation-menu-toggle">
  <div class="container mx-auto">
    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-end">
      <nav role="navigation" itemscope itemtype="https://schema.org/SiteNavigationElement">
        <ul class="ml-auto mb-2 lg:mb-0">
          
          <li class="list-none lg:inline-block" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a class="py-2 inline-block no-underline hover:text-gray-900 hover:underline dark:hover:text-white lg:p-2 lg:mr-2" href="https://henriquefreitassouza.github.io/stories" itemprop="item">
              <span class="text-base dark:text-white" itemprop="name">Todas as Hist√≥rias</span>
            </a>
          </li>
          
        </ul>
      </nav>
      <div itemscope itemtype="https://schema.org/WebSite">
  <form class="inline-search flex p-2 mb-2 border-2 rounded-lg dark:bg-white lg:mb-0" itemprop="potentialAction" itemscope itemtype="https://schema.org/SearchAction" action="https://henriquefreitassouza.github.io/search/" role="search" method="get">
    <meta itemprop="target" content="https://henriquefreitassouza.github.io/search/">
    <label class="sr-only" for="q">Buscar hist√≥rias</label>
    <input class="text-sm px-4 w-full focus:outline-none focus:border-transparent dark:text-gray-900" itemprop="query" id="q" name="q" type="search" aria-label="Buscar em todo o site" placeholder='Buscar hist√≥rias'>
    <button class="p-2 text-base focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-secondary-darker" type="submit">
      <span class="sr-only">Iniciar a busca</span>
      <i class="search-icon w-4 h-4"></i>
    </button>
  </form>
</div>

    </div>
  </div>
</div>

    </div>
  </div>
</header>

      <main id="content" class="flex-grow">
        


<article role="article" itemscope itemtype="https://schema.org/Article">
  <header>

  


  
  
  
  
  
<div class="relative py-8">
  
    
  <div class="absolute inset-0 bg-cover bg-center filter brightness-75" style="background-image: url('https://henriquefreitassouza.github.io/stories/geracao-de-relatorios-automatizados-por-apis/images/thumbnail_hub1e5e732d76e00468e1c634cdaec8917_61940_1024x400_fill_q75_h2_box_smart1_2.webp');"></div>
  
  <div class="relative container container-box mx-auto">
    <div class="flex justify-between items-center mb-6 px-2">
      <div class="flex flex-col lg:flex-row">
        
        <address class="text-white text-base" itemprop="author">Henrique</address>
        <time class="text-white text-base lg:ml-2" pubdate datetime="2017-11-19 13:13:00 &#43;0000 UTC" itemprop="datePublished">19/11/2017 13:13:00</time>
        
      </div>
      <a class="badge dark:ring-offset-secondary-darker" href="https://henriquefreitassouza.github.io/categories/automa%C3%A7%C3%A3o" itemprop="articleSection">automa√ß√£o</a>
    </div>
    <div class="flex flex-col px-2">
      
      <div>
        <h1 class="text-white text-5xl break-words lg:text-6xl lg:break-normal" itemprop="headline">Gera√ß√£o de relat√≥rios automatizados por APIs</h1>
      </div>
      <div>
        
        <p class="text-white text-2xl" itemprop="abstract">Recentemente me envolvi em um projeto em que eu precisava construir um reposit√≥rio de dados para alimenta√ß√£o de relat√≥rios. As fontes que continham as informa√ß√µes de interesse estavam espalhadas em pelo menos 6 sistemas diferentes e juntar essas informa√ß√µes semanalmente demandava um bom tempo. Este post descreve a solu√ß√£o que encontrei para tornar este tempo mais produtivo.</p>
        
      </div>
      
    </div>
  </div>
</div>



  </header>
  <div class="bg-secondary hidden dark:bg-neutral lg:block">
    <div class="container container-box mx-auto">
      <div class="px-2">
      <nav aria-label="Breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
  <ul class="flex ml-auto mb-0">
    
  
    
  
    
  

  
  <li class="flex relative pr-7 last:pr-0 dark:filter dark:invert" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
    <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-gray-100" href="https://henriquefreitassouza.github.io/" itemprop="item">
      
      <span class="text-white" itemprop="name">Home</span>
      
    </a>
    <i class="breadcrumb-separator"></i>
  </li>
  

  

  
  <li class="flex relative pr-7 last:pr-0 dark:filter dark:invert" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
    <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-gray-100" href="https://henriquefreitassouza.github.io/stories/" itemprop="item">
      
        <span class="text-white" itemprop="name">Todas as hist√≥rias</span>
      
    </a>
    <i class="breadcrumb-separator"></i>
  </li>
  

  

  
  <li class="flex relative pr-7 last:pr-0 dark:filter dark:invert" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
    <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-gray-100" href="https://henriquefreitassouza.github.io/stories/geracao-de-relatorios-automatizados-por-apis/" aria-current="page" itemprop="item">
      <span class="text-white" itemprop="name">Gera√ß√£o de relat√≥rios automatizados por APIs</span>
    </a>
  </li>
  

  </ul>
</nav>



      </div>
    </div>
  </div>
  <div class="container container-box mx-auto">
    <div class="max-w-3xl px-2 mx-auto flex flex-col">
      <main id="post" itemprop="articleBody">
        <strong class="inline-block text-base mb-4 dark:text-white">Tempo estimado para a leitura: 6 minutos</strong>
        <p>Publicado em 19/11/2017. Atualizado em 17/10/2021.</p>
<p>Automa√ß√£o √© fundamental para escala e ganho de produtividade. Automatizar tarefas com algum grau de repetitividade significa aproveitar melhor o tempo para pensar em quest√µes mais estrat√©gicas ou t√°ticas de um neg√≥cio. Uma automa√ß√£o bem feita significa tamb√©m redu√ß√£o de custos uma vez que √© poss√≠vel escalar cada vez mais r√°pido com pouco ou nenhum aumento nos custos necess√°rios para manter a opera√ß√£o. Uma mal feita, ao contr√°rio, custa para manter e n√£o escala apropriadamente.</p>
<p>Hoje em dia h√° centenas de ferramentas de manipula√ß√£o e visualiza√ß√£o de dados para as mais variadas necessidades de neg√≥cio. Podemos citar plataformas para gest√£o de an√∫ncios, CRM, analytics, sistemas administrativos e tantas outras. Acontece que muitas das informa√ß√µes que alimentam tais plataformas precisam ser extra√≠das e combinadas em diferentes vis√µes para auxiliar tomadores de decis√£o, e nem sempre h√° uma integra√ß√£o nativa entre as ferramentas envolvidas. Esse cen√°rio gera in√∫meras planilhas e documentos que fazem o meio de campo, carregados com dados de v√°rios sistemas que s√£o baixados e tratados manualmente, portanto, sujeito a falhas humanas e aumento do tempo dedicado a tarefas rotineiras.</p>
<p>Nem sempre a solu√ß√£o √© construir um <em>middleware</em>. Ela pode ser mais simples e barata. Ela pode at√© mesmo utilizar estas mesmas planilhas e documentos que fazem o meio de campo. Planilhas s√£o extremamente din√¢micas quanto as possibilidades para ingest√£o e tratamento de dados. H√° muitos casos em que faz sentido manter uma planilha atualizada com certa frequ√™ncia em prol de construir uma ferramenta, especialmente se o or√ßamento for baixo. O trabalho que desenvolvi resultou em uma destas planilhas, cujas informa√ß√µes traziam o estado de sa√∫de financeira da organiza√ß√£o.</p>
<h2 id="automa√ß√£o-com-apis">Automa√ß√£o com APIs</h2>
<p>As fontes das quais precisei extrair dados permitem n√£o s√≥ a exporta√ß√£o dos dados para planilha, mas tamb√©m em um formato chamado JSON. O nome √© um acr√¥nimo para <em>Javascript Object Notation</em>, e esse tipo de arquivo √© muito usado para criar comunica√ß√µes entre sistemas que, a priori, n√£o se entendem. Um exemplo desse formato:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#111">{</span>
  <span style="color:#f92672">&#34;nome&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;Adwords&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;conta&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;xpto&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;gasto_total&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;48032.44&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;impressoes&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;188492&#34;</span>
<span style="color:#111">}</span></code></pre></td></tr></table>
</div>
</div>
<p>Cada linha entre as chaves representa um par, em forma de chave e valor. A chave representa um identificador enquanto o valor √© o conte√∫do da chave. O conjunto de pares entre os s√≠mbolos de chave recebe o nome de objeto. Um objeto pode conter v√°rios pares de chaves e valores dentro dele e armazenar at√© mesmo outros objetos.</p>
<p>O JSON √© um formato √∫til por ser padr√£o entre diferentes tecnologias. Todas as linguagens de programa√ß√£o mais conhecidas possuem uma forma para enviar e receber objetos JSON pela internet, e por isso √© comum que este seja um dos formatos mais adotados para integrar ferramentas. Diversas ferramentas fornecem um servi√ßo capaz de entregar objetos JSON para quem os solicita - geralmente outros sistemas. Este servi√ßo √© chamado de API, ou <em>Application Programming Interface</em>, uma esp√©cie de ponte que entrega determinados dados conforme solicitado.</p>
<h2 id="um-exemplo-pr√°tico-de-funcionamento-de-apis">Um exemplo pr√°tico de funcionamento de APIs</h2>
<p>Imagine que voc√™ queira saber as avalia√ß√µes dadas pela cr√≠tica ao filme Batman: O Cavaleiro Das Trevas Retorna. Uma base de dados como a fornecida pela <a href="http://www.omdbapi.com/" target="_blank" rel="noopener">OMDB</a> possui as informa√ß√µes que voc√™ busca e disponibiliza uma API para fazer a consulta. Basta acessar o endere√ßo <a href="http://www.omdbapi.com/?apikey=">http://www.omdbapi.com/?apikey=</a><strong>sua_api_key</strong>&amp;t=Batman+The+Dark+Knight e voc√™ ter√° uma informa√ß√£o como esta:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#111">{</span>
  <span style="color:#f92672">&#34;Title&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;Batman: The Dark Knight Returns, Part 1&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Year&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;2012&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Rated&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;PG-13&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Released&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;25 Sep 2012&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Genre&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;Animation, Action, Adventure&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Language&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;English&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Country&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;USA&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Awards&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;5 nominations.&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Metascore&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;N/A&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;imdbRating&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;8.0&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;imdbVotes&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;42,023&#34;</span><span style="color:#111">,</span>
<span style="color:#111">}</span></code></pre></td></tr></table>
</div>
</div>
<p>A por√ß√£o do endere√ßo com o termo &ldquo;sua_api_key&rdquo; se refere a autentica√ß√£o. Toda chamada a API da OMDB deve ser feita com uma chave que identifica a pessoa (ou sistema) que fez a requisi√ß√£o, e apenas usu√°rios verificados podem ver as informa√ß√µes sobre os filmes. Voc√™ pode se cadastrar gratuitamente no site da OMDB para receber uma chave de acesso a API. O JSON retornado foi simplificado, mas a avalia√ß√£o buscada retornou a chave &ldquo;imdbRating&rdquo;, com o valor 8.0. Talvez voc√™ ainda esteja se perguntando qual a utilidade de encontrar essas informa√ß√µes desta forma quando podemos simplesmente acessar o site da IMDB e encontrar a listagem do filme. √â aqui que come√ßamos a falar de automa√ß√£o: este trabalho pode ser feito uma √∫nica vez e configurado para ser re-executado sempre que voc√™ quiser, desta forma o objeto JSON que retorna ter√° sempre os valores mais recentes a sua disposi√ß√£o. Este pode n√£o ser o melhor exemplo para fazer buscas com certa frequ√™ncia, mas imagine que estes dados sejam o valor de a√ß√µes de empresas e que voc√™ est√° montando um quadro de m√©tricas que precisa do valor das a√ß√µes atualizadas de hora em hora. Basta configurar uma rotina que vai chamar a API do servi√ßo financeiro de hora em hora e buscar o valor mais recente das a√ß√µes, e assim voc√™ n√£o tem que buscar essa informa√ß√£o manualmente sempre que precisar.</p>
<h2 id="de-volta-ao-projeto-de-automa√ß√£o">De volta ao projeto de automa√ß√£o</h2>
<p>As ferramentas com as quais trabalhei para extrair as informa√ß√µes que precisava possuem APIs com vasta documenta√ß√£o e diversos endere√ßos para puxar dados diferentes. Uma vez que capturei os objetos JSON, o trabalho foi alimentar a fonte, isto √©, o local que recebeu e tratou os dados vindos dos sistemas. Esse local, que serviria de fonte para o painel de relat√≥rios, foi uma planilha criada no Google Sheets. O Google Sheets foi escolhido por possuir uma ferramenta de cria√ß√£o de scripts chamada <a href="https://www.google.com/script/" target="_blank" rel="noopener">Google Apps Script</a>, usada para, entre outras coisas, estender as capacidades padr√£o das ferramentas do Google. Um dos recursos da ferramenta √© se comunicar com outros sistemas pela internet, o que atendeu a expectativa.</p>
<p>Com o editor de scripts aberto, algumas poucas linhas de c√≥digo j√° me trouxeram os objetos JSON que precisava:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#00a8c8">var</span> <span style="color:#75af00">spreadsheet</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;https://sheets.google.com/id=spreadsheet1&#34;</span><span style="color:#111">;</span>
<span style="color:#00a8c8">var</span> <span style="color:#75af00">sheet</span> <span style="color:#f92672">=</span> <span style="color:#75af00">SpreadsheetApp</span><span style="color:#111">.</span><span style="color:#75af00">openByUrl</span><span style="color:#111">(</span><span style="color:#75af00">spreadsheet</span><span style="color:#111">).</span><span style="color:#75af00">getSheetByName</span><span style="color:#111">(</span><span style="color:#d88200">&#34;name&#34;</span><span style="color:#111">);</span>
<span style="color:#75715e">// Essa chamada ir√° retornar um JSON como o do exemplo anterior
</span><span style="color:#75715e"></span><span style="color:#00a8c8">var</span> <span style="color:#75af00">url</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;http://www.omdbapi.com/?apikey=sua_api_key&amp;t=Batman+The+Dark+Knight&#34;</span><span style="color:#111">;</span>
<span style="color:#00a8c8">var</span> <span style="color:#75af00">response</span> <span style="color:#f92672">=</span> <span style="color:#75af00">UrlFetchApp</span><span style="color:#111">.</span><span style="color:#75af00">fetch</span><span style="color:#111">(</span><span style="color:#75af00">url</span><span style="color:#111">);</span>
<span style="color:#00a8c8">var</span> <span style="color:#75af00">json</span> <span style="color:#f92672">=</span> <span style="color:#75af00">JSON</span><span style="color:#111">.</span><span style="color:#75af00">parse</span><span style="color:#111">(</span><span style="color:#75af00">response</span><span style="color:#111">);</span>
<span style="color:#75715e">// Como eu s√≥ quero a informa√ß√£o de avalia√ß√£o, seleciono apenas ela dentro do JSON retornado
</span><span style="color:#75715e"></span><span style="color:#75af00">sheet</span><span style="color:#111">.</span><span style="color:#75af00">getRange</span><span style="color:#111">(</span><span style="color:#d88200">&#34;A1&#34;</span><span style="color:#111">).</span><span style="color:#75af00">setValue</span><span style="color:#111">(</span><span style="color:#75af00">json</span><span style="color:#111">.</span><span style="color:#75af00">imdbRating</span><span style="color:#111">);</span></code></pre></td></tr></table>
</div>
</div>
<p>Isso poderia ter sido feito de v√°rias formas, mas o processo √© id√™ntico:</p>
<ul>
<li>acessar o endere√ßo;</li>
<li>capturar o JSON retornado;</li>
<li>prepar√°-lo para uso (desserializ√°-lo);</li>
<li>escrever os dados recebidos na planilha.</li>
</ul>
<p>Usei o exemplo do OMDB pois a API √© p√∫blica, diferente das que eu usei no caso pr√°tico.</p>
<p>Para finalizar, o pr√≥prio editor de scripts dos aplicativos do Google possui uma op√ß√£o para definir uma periodicidade para execu√ß√£o dos scripts. Apenas configurei a ferramenta para executar a cada hora e pronto! Constru√≠ um sistema de alimenta√ß√£o de dados automatizado. √â importante ficar atento a atualiza√ß√µes nas APIs e seus endere√ßos, mas n√£o √© todo dia que isso acontece, ent√£o voc√™ pode se dar ao luxo de concentrar seus esfor√ßos e tempo em compreender os dados que est√£o chegando ao relat√≥rio, e n√£o na manuten√ß√£o dele.</p>

      </main>
      <footer>
        


<div class="h-1 w-16 my-6 bg-gray-900 mx-auto dark:bg-white"></div>
<div class="flex justify-center items-center" itemprop="author" itemscope itemtype="https://schema.org/Person">
  <div class="mr-4 w-3/12 md:w-2/12">
    <img class="rounded-full" src="/images/profiles/henriquesouza/profile.webp" alt="Henrique Freitas Souza" itemprop="image">
  </div>
  <div class="w-9/12 md:w-10/12">
    <address class="font-title dark:text-white" itemprop="name">Henrique Freitas Souza</address>
    
    <p class="mb-auto text-base dark:text-white" itemprop="description">Certa vez li que dados s√£o como res√≠duos nucleares. Desde ent√£o tomo cuidado redobrado com o uso que fa√ßo deles.</p>
    
  </div>
</div>


      </footer>
    </div>
  </div>
</article>

  
  
<div class="container container-box mx-auto">
  <div class="px-2 lg:px-0">
    <aside role="complementary">
      <span class="inline-block w-full font-title text-3xl text-center mb-4 px-2 dark:text-white">Leia tamb√©m estas hist√≥rias</span>
      <div class="lg:flex lg:flex-wrap lg:justify-start">
        
          




<div class="mb-4 lg:mb-0 lg:p-2 lg:w-1/2 xl:w-1/3">
  <article class="relative flex flex-col bg-gray-300 p-6 h-full rounded-lg dark:bg-secondary-darker" role="article" itemscope itemtype="https://schema.org/Article">
  
    
    <div class="absolute inset-0 bg-cover bg-center filter brightness-50 rounded-lg" style="background-image: url('https://henriquefreitassouza.github.io/stories/configurando-metabase-e-postgresql-no-docker/images/thumbnail_huc18ba163cc1b2c8427f1d4131553cbf6_20916_500x500_fill_q75_h2_box_smart1_2.webp');"></div>
  
    <header class="relative flex flex-wrap justify-between items-center mb-6">
      
      <div>
        <address class="text-white text-base" itemprop="author">Henrique</address>
        <time class="text-white text-base" itemprop="datePublished" pubdate datetime="2020-11-17 09:10:00 &#43;0000 UTC">17/11/2020 09:10:00</time>
      </div>
      <a href="https://henriquefreitassouza.github.io/categories/automa%C3%A7%C3%A3o" class="badge" itemprop="articleSection">automa√ß√£o</a>
      
    </header>
    <main class="relative" itemprop="articleBody">
      
      <h2 class="text-white" itemprop="headline">Configurando Metabase e PostgreSQL no Docker</h2>
      <p class="mb-6 text-white" itemprop="abstract">Como elaborar uma arquitetura de servi√ßos simples, de f√°cil manuten√ß√£o e port√°til utilizando o Docker? Ao longo deste post, voc√™ vai descobrir como fazer isso integrando um banco de dados PostgreSQL ‚Ä¶</p>
      <div>
        <a class="button-primary" href="https://henriquefreitassouza.github.io/stories/configurando-metabase-e-postgresql-no-docker/">Leia mais</a>
      </div>
      
    </main>
  </article>
</div>

        
          




<div class="mb-4 lg:mb-0 lg:p-2 lg:w-1/2 xl:w-1/3">
  <article class="relative flex flex-col bg-gray-300 p-6 h-full rounded-lg dark:bg-secondary-darker" role="article" itemscope itemtype="https://schema.org/Article">
  
    
    <div class="absolute inset-0 bg-cover bg-center filter brightness-50 rounded-lg" style="background-image: url('https://henriquefreitassouza.github.io/stories/rd-station-e-google-sheets-na-aws/images/thumbnail_hu517c4242f43279c503dd63d10e255f77_19128_500x500_fill_q75_h2_box_smart1_2.webp');"></div>
  
    <header class="relative flex flex-wrap justify-between items-center mb-6">
      
      <div>
        <address class="text-white text-base" itemprop="author">Henrique</address>
        <time class="text-white text-base" itemprop="datePublished" pubdate datetime="2020-09-03 19:23:00 &#43;0000 UTC">03/09/2020 19:23:00</time>
      </div>
      <a href="https://henriquefreitassouza.github.io/categories/automa%C3%A7%C3%A3o" class="badge" itemprop="articleSection">automa√ß√£o</a>
      
    </header>
    <main class="relative" itemprop="articleBody">
      
      <h2 class="text-white" itemprop="headline">RD Station e Google Sheets Parte 2 - Migrando para a AWS</h2>
      <p class="mb-6 text-white" itemprop="abstract">J√° vimos neste blog como fazer para enviar leads do RD Station para uma planilha automaticamente. Agora vamos ver como enviar estes mesmos leads para um banco de dados hospedado na AWS</p>
      <div>
        <a class="button-primary" href="https://henriquefreitassouza.github.io/stories/rd-station-e-google-sheets-na-aws/">Leia mais</a>
      </div>
      
    </main>
  </article>
</div>

        
          




<div class="mb-4 lg:mb-0 lg:p-2 lg:w-1/2 xl:w-1/3">
  <article class="relative flex flex-col bg-gray-300 p-6 h-full rounded-lg dark:bg-secondary-darker" role="article" itemscope itemtype="https://schema.org/Article">
  
    
    <div class="absolute inset-0 bg-cover bg-center filter brightness-50 rounded-lg" style="background-image: url('https://henriquefreitassouza.github.io/stories/rd-station-e-google-sheets/images/thumbnail_huae7656d4982a87c6d57e9e975962d1d6_14188_500x500_fill_q75_h2_box_smart1_2.webp');"></div>
  
    <header class="relative flex flex-wrap justify-between items-center mb-6">
      
      <div>
        <address class="text-white text-base" itemprop="author">Henrique</address>
        <time class="text-white text-base" itemprop="datePublished" pubdate datetime="2018-09-02 14:07:00 &#43;0000 UTC">02/09/2018 14:07:00</time>
      </div>
      <a href="https://henriquefreitassouza.github.io/categories/automa%C3%A7%C3%A3o" class="badge" itemprop="articleSection">automa√ß√£o</a>
      
    </header>
    <main class="relative" itemprop="articleBody">
      
      <h2 class="text-white" itemprop="headline">RD Station e Google Sheets: exporta√ß√£o autom√°tica de leads para planilhas</h2>
      <p class="mb-6 text-white" itemprop="abstract">Saiba como enviar dados de leads automaticamente para planilhas no Google Sheets a partir do software de automa√ß√£o de marketing RD Station.</p>
      <div>
        <a class="button-primary" href="https://henriquefreitassouza.github.io/stories/rd-station-e-google-sheets/">Leia mais</a>
      </div>
      
    </main>
  </article>
</div>

        
      </div>
    </aside>
  </div>
</div>
  


      </main>
      <footer>
        <div class="bg-secondary-darker">
  <div class="container container-box mx-auto">
    <div class="flex flex-wrap justify-between px-2 lg:px-0">
      <div class="w-full mb-6 last:mb-auto lg:mb-auto lg:p-2 lg:w-2/4">
        <div class="flex items-center mb-4">
          <img src="/images/automacaodedados_logo_white.svg" alt="Logo Automa√ß√£o de Dados" class="mr-2 w-16 h-8">
          <span class="font-title inline-block text-white text-base">Automa√ß√£o de Dados</span>
        </div>
        <p class="text-white">Espa√ßo para a divulga√ß√£o de informa√ß√µes que ajudem a democratizar o conhecimento de novas tecnologias no Brasil.</p>
      </div>
      <div class="w-full mb-6 last:mb-auto lg:mb-auto lg:p-2 lg:w-1/4">
  <span class="font-title inline-block mb-4 text-white text-base">Todas as categorias</span>
  <nav role="navigation" itemscope itemtype="https://schema.org/SiteNavigationElement">
    <ul class="list-none ml-auto">
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/analytics/" itemprop="item">
          <span class="text-white" itemprop="name">Analytics</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/an%C3%A1lise/" itemprop="item">
          <span class="text-white" itemprop="name">An√°lise</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/automa%C3%A7%C3%A3o/" itemprop="item">
          <span class="text-white" itemprop="name">Automa√ß√£o</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/design/" itemprop="item">
          <span class="text-white" itemprop="name">Design</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/empreendedorismo/" itemprop="item">
          <span class="text-white" itemprop="name">Empreendedorismo</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/estat%C3%ADstica/" itemprop="item">
          <span class="text-white" itemprop="name">Estat√≠stica</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/governan%C3%A7a/" itemprop="item">
          <span class="text-white" itemprop="name">Governan√ßa</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/marketing/" itemprop="item">
          <span class="text-white" itemprop="name">Marketing</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/programa%C3%A7%C3%A3o/" itemprop="item">
          <span class="text-white" itemprop="name">Programa√ß√£o</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/categories/visualiza%C3%A7%C3%A3o/" itemprop="item">
          <span class="text-white" itemprop="name">Visualiza√ß√£o</span>
        </a>
      </li>
      
    </ul>
  </nav>
</div>
<div class="w-full mb-6 last:mb-auto lg:mb-auto lg:p-2 lg:w-1/4">
  <span class="font-title inline-block mb-4 text-white text-base">√öltimas hist√≥rias</span>
  <nav role="navigation" itemscope itemtype="https://schema.org/SiteNavigationElement">
    <ul class="list-none ml-auto">
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/stories/construcao-da-identidade-no-espaco-virtual/" itemprop="item">
          <span class="text-white" itemprop="name">Constru√ß√£o da identidade no espa√ßo virtual</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/stories/como-escolher-o-melhor-grafico/" itemprop="item">
          <span class="text-white" itemprop="name">Como escolher o melhor gr√°fico?</span>
        </a>
      </li>
      
      <li class="mb-2 last:mb-auto" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a class="text-white no-underline hover:text-white hover:underline dark:hover:text-white" href="https://henriquefreitassouza.github.io/stories/configurando-metabase-e-postgresql-no-docker/" itemprop="item">
          <span class="text-white" itemprop="name">Configurando Metabase e PostgreSQL no Docker</span>
        </a>
      </li>
      
    </ul>
  </nav>
</div>

    </div>
  </div>
</div>
<div class="bg-gray-300">
  <div class="container container-box mx-auto">
    <div class="text-center lg:flex lg:justify-between lg:items-center lg:text-left px-2">
      <span class="inline-block text-base dark:text-gray-900">Feito com Hugo &#43; Tailwind e hospedado no Github Pages.</span>
      <div itemscope itemtype="https://schema.org/Language">
        <ul class="ml-auto mb-0">
          
          <li class="inline-block" itemprop="availableLanguage" itemscope itemtype="https://schema.org/Language">
            <a class="px-2 py-1 text-base no-underline hover:text-gray-900 hover:underline dark:text-gray-900 dark:hover:text-gray-900" href="https://henriquefreitassouza.github.io/" itemprop="name">üáßüá∑ Portugu√™s</a>
          </li>
          
          <li class="inline-block" itemprop="availableLanguage" itemscope itemtype="https://schema.org/Language">
            <a class="px-2 py-1 text-base no-underline hover:text-gray-900 hover:underline dark:text-gray-900 dark:hover:text-gray-900" href="https://henriquefreitassouza.github.io/en/" itemprop="name">üá∫üá∏ English</a>
          </li>
          
        </ul>
      </div>
    </div>
  </div>
</div>

      </footer>
    </div>
    <script src="/js/theme.min.js"></script>

    
<script src="/js/lazy.min.js" async></script>

  </body>
</html>
